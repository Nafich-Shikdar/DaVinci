<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Font Finder - Bangla Fonts</title>
    
    <!-- React & Tailwind -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1); width: 36px; height: 36px;
            border-radius: 50%; border-left-color: #4f46e5; animation: spin 1s ease infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- CONFIG UPDATED ---
        const GITHUB_USERNAME = 'Nafich-Shikdar';
        const GITHUB_REPO = 'DaVinci'; // Repo changed
        const GITHUB_BRANCH = 'main';
        const BASE_PATH = 'Font-Finder'; // Sub-folder path

        // Icons Components
        const IconDownload = ({className}) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>;
        const IconSearch = ({className}) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>;
        const IconMoon = ({className}) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>;
        const IconSun = ({className}) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>;

        function App() {
            const [fonts, setFonts] = useState([]);
            const [loading, setLoading] = useState(true);
            const [previewText, setPreviewText] = useState('আমার সোনার বাংলা, আমি তোমায় ভালোবাসি।');
            const [fontSize, setFontSize] = useState(32);
            const [searchQuery, setSearchQuery] = useState('');
            const [darkMode, setDarkMode] = useState(true);

            // Fetch Data from JSON
            useEffect(() => {
                // Since index.html is in the same folder as fonts.json, relative path works
                fetch('./fonts.json')
                    .then(res => res.json())
                    .then(data => {
                        const processedFonts = data.map(font => ({
                            ...font,
                            // Updated URL structure for sub-folder
                            url: `https://cdn.jsdelivr.net/gh/${GITHUB_USERNAME}/${GITHUB_REPO}@${GITHUB_BRANCH}/${BASE_PATH}/fonts/${font.filename}`
                        }));
                        setFonts(processedFonts);
                        setLoading(false);
                    })
                    .catch(err => {
                        console.error("Error fetching fonts.json:", err);
                        setLoading(false);
                    });
            }, []);

            // Inject CSS for fonts
            useEffect(() => {
                const style = document.createElement('style');
                let css = '';
                fonts.forEach(font => {
                    const fontName = font.name.replace(/\s+/g, '');
                    css += `
                        @font-face {
                            font-family: '${fontName}';
                            src: url('${font.url}');
                            font-display: swap;
                        }
                    `;
                });
                style.appendChild(document.createTextNode(css));
                document.head.appendChild(style);
                return () => {
                    if (document.head.contains(style)) document.head.removeChild(style);
                };
            }, [fonts]);

            const filteredFonts = fonts.filter(font => 
                font.name.toLowerCase().includes(searchQuery.toLowerCase())
            );

            return (
                <div className={`min-h-screen transition-colors duration-300 ${darkMode ? 'bg-slate-900 text-slate-100' : 'bg-slate-50 text-slate-900'}`}>
                    {/* Header */}
                    <header className={`sticky top-0 z-50 border-b backdrop-blur-md ${darkMode ? 'bg-slate-900/80 border-slate-700' : 'bg-white/80 border-slate-200'}`}>
                        <div className="container mx-auto px-4 py-4 flex justify-between items-center">
                            <h1 className="text-2xl font-bold bg-gradient-to-r from-indigo-500 to-purple-500 bg-clip-text text-transparent">Font Finder</h1>
                            <button onClick={() => setDarkMode(!darkMode)} className="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-slate-700">
                                {darkMode ? <IconSun className="w-5 h-5"/> : <IconMoon className="w-5 h-5"/>}
                            </button>
                        </div>
                    </header>

                    {/* Controls */}
                    <div className="container mx-auto px-4 py-8 space-y-4">
                        <div className="flex flex-col md:flex-row gap-4">
                            <input 
                                type="text" 
                                value={previewText} 
                                onChange={(e) => setPreviewText(e.target.value)} 
                                className={`flex-1 p-3 rounded-xl border outline-none focus:ring-2 focus:ring-indigo-500 ${darkMode ? 'bg-slate-800 border-slate-600' : 'bg-white border-slate-300'}`}
                                placeholder="Type preview text..."
                            />
                            <div className="relative md:w-1/4">
                                <IconSearch className="absolute left-3 top-3.5 text-gray-400 w-4 h-4"/>
                                <input 
                                    type="text" 
                                    value={searchQuery} 
                                    onChange={(e) => setSearchQuery(e.target.value)} 
                                    className={`w-full pl-9 p-3 rounded-xl border outline-none focus:ring-2 focus:ring-indigo-500 ${darkMode ? 'bg-slate-800 border-slate-600' : 'bg-white border-slate-300'}`}
                                    placeholder="Search fonts..."
                                />
                            </div>
                        </div>
                        <input 
                            type="range" 
                            min="12" max="96" 
                            value={fontSize} 
                            onChange={(e) => setFontSize(Number(e.target.value))} 
                            className="w-full accent-indigo-600"
                        />
                    </div>

                    {/* Font Grid */}
                    <main className="container mx-auto px-4 pb-12">
                        {loading ? (
                            <div className="flex justify-center py-20"><div className="spinner"></div></div>
                        ) : (
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                {filteredFonts.map((font, idx) => (
                                    <div key={idx} className={`rounded-2xl border overflow-hidden ${darkMode ? 'bg-slate-800 border-slate-700' : 'bg-white border-slate-200'}`}>
                                        <div className="p-4 border-b border-gray-100 dark:border-slate-700 flex justify-between items-center">
                                            <div>
                                                <h3 className="font-bold">{font.name}</h3>
                                                <p className="text-xs opacity-60">{font.author}</p>
                                            </div>
                                            <span className="text-xs px-2 py-1 bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-300 rounded">{font.category}</span>
                                        </div>
                                        <div className="h-40 flex items-center justify-center p-4 overflow-hidden">
                                            <p style={{fontFamily: `'${font.name.replace(/\s+/g, '')}', sans-serif`, fontSize: `${fontSize}px`}} className="text-center break-words w-full">
                                                {previewText}
                                            </p>
                                        </div>
                                        <div className="p-4 bg-gray-50 dark:bg-slate-900/50 flex justify-end">
                                            <a href={font.url} download className="flex items-center gap-2 text-sm font-medium text-indigo-600 hover:text-indigo-500">
                                                <IconDownload className="w-4 h-4"/> Download
                                            </a>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
